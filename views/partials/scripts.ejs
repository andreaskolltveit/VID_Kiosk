<!-- Include the necessary JavaScript libraries for popovers, tooltips, and custom scripts -->
<script src="../js/popper.min.js"></script>
<script src="../js/bootstrap.bundle.min.js"></script>
<script src="../js/custom.js"></script>

<!-- Script for managing toast notifications using Bootstrap Toast component -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  // Retrieve all toast elements
  var toastElList = [].slice.call(document.querySelectorAll('.toast'));

  // Create an array of Bootstrap Toast instances
  var toastList = toastElList.map(function (toastEl) {
    var bsToast = new bootstrap.Toast(toastEl);

    // Hide other toasts when a new one is shown
    toastEl.addEventListener('show.bs.toast', function () {
      toastList.filter(function (otherToast) {
        return otherToast !== bsToast;
      }).forEach(function (otherToast) {
        otherToast.hide();
      });
    });

    return bsToast;
  });

  // Attach click event listeners to toast toggle buttons
  var toastButtons = document.querySelectorAll('[data-bs-toggle="toast"]');
  toastButtons.forEach(function (button, index) {
    button.addEventListener('click', function () {
      toastList[index].show();
    });
  });
});

</script>

<script>
  // Log a message indicating that the script is running
  console.log('Script is running.');

  // Identify the current page using its pathname
  const currentPage = window.location.pathname;

  // Send a request to the server to increment the visit count for the current page
  fetch(`/visit?page=${encodeURIComponent(currentPage)}`)
    .then(response => response.json())
    .then(data => {
      console.log(`Visited ${currentPage}. New count: ${data.count}`);

      // Display the updated visit count in a table on the webpage
      const logTableBody = document.getElementById('logTableBody');
      const row = document.createElement('tr');
      row.innerHTML = `<td>${currentPage}</td><td>${data.count}</td>`;
      logTableBody.appendChild(row);
    });
</script>